Newlyweds Shrek and Fiona return from their honeymoon to find they have been invited by Fiona's parents to a royal ball to celebrate their marriage. Shrek refuses to go at first, but Fiona talks him into it, and along with Donkey, they travel to the kingdom of Far Far Away. They meet Fiona's parents, King Harold and Queen Lillian, who are shocked to see both their daughter and son-in-law are ogres, with Harold particularly repulsed. At dinner, Shrek and Harold get into a heated argument over how Shrek and Fiona will raise their family, and Fiona, disgusted at Shrek and Harold's behavior, locks herself away in her room that evening. Shrek worries that he has lost his true love, particularly after finding her childhood diary and reading that she was once infatuated with Prince Charming. Harold is reprimanded by the Fairy Godmother and her son Prince Charming by reminding him that Charming was to marry Fiona in exchange for his own happy ending. She implores him to find a way of getting rid of Shrek. Harold arranges for Shrek and Donkey to join him on a fictitious hunting trip, which is actually a trap to lure them into the hands of an assassin, Puss in Boots. Unable to defeat Shrek, Puss reveals that he was paid by Harold and offers to come along and make amends. The three sneak into the Fairy Godmother's potion factory by pretending to be representatives of a worker's union and steal a """Happily" Ever "After""" potion that Shrek thinks will restore Fiona's love for him. Shrek and Donkey both drink the potion and fall into a deep sleep, awakening the next morning to discover its effects: Shrek is now a handsome man while Donkey has turned into an elegant white stallion. In order to make the change permanent, Shrek must kiss Fiona by midnight. Shrek, Donkey, and Puss return to the castle to discover that the potion has transformed Fiona back into her former human self as well. However, the Fairy Godmother, having discovered the potion's theft, intercepts Shrek and sends Charming to pose as him and win Fiona's love. At the Fairy Godmother's urging, Shrek leaves the castle, believing that the best way to make Fiona happy is to let her go. To ensure that Fiona falls in love with Charming, the Fairy Godmother gives Harold a love potion to put into Fiona's tea. This exchange is overheard by Shrek, Donkey, and Puss, who are arrested by the royal guards and thrown into a dungeon. While the royal ball begins, several of Shrek's friends band together to free the trio with the help of The Muffin Man's monster-sized gingerbread man, which breaks through the castle's defenses. Shrek is too late to prevent Charming from kissing Fiona, but instead of falling in love with Charming, Fiona knocks him out with a headbutt. Harold reveals that he never gave Fiona the love potion, whereupon the now-enraged Fairy Godmother attacks Shrek. In the ensuing melee, Harold sacrifices himself to save Shrek; his armor ricochets a spell cast by the Fairy Godmother which disintegrates her, and Harold is turned back into the Frog Prince, his true form. Harold gives his blessing to the marriage and apologizes for his earlier behavior, admitting his use of the Happily Ever After potion years earlier to gain Lillian's love. Lillian assures Harold that she loves him and not his appearance. As the clock strikes midnight, Fiona rejects Shrek's offer to remain humans, and they happily let the potion's effects wear off and revert to their ogre forms, while Donkey changes back to his natural form as well. In the mid-credits scene, Dragon, who had previously romanced Donkey, reveals that they now have several dragon-donkey hybrid babies, much to his surprise.
