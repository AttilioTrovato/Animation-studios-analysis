In a flashback, King Harold and Queen Lillian are about to sign the kingdom of Far Far Away over to """Rumpel""" Rumpelstiltskin, in exchange for lifting their daughter Princess Fiona's curse. The deal is canceled at the last second when a messenger informs the king and queen that Fiona has been rescued. In the present time, an angry Rumpel laments his loss and wishes that Fiona's rescuer; Shrek, was never born. Meanwhile, Shrek has grown steadily weary of being a family man and celebrity among the villagers, leading him to long for when he was feared and had privacy. When he takes his family to a restaurant in Far Far Away to celebrate his children's first birthday, an escalating series of mishaps further injure his ego, causing him to walk out in anger. Having observed the outburst, Rumpel follows Shrek and arranges for him to appear to save his life. Inside Rumpel's carriage, Shrek laments that he is no longer a """real" "ogre""." Pretending to thank Shrek for his good deed earlier, Rumpel offers Shrek a deal: A day as a """real" "ogre""" in exchange for a day from his childhood. Shrek signs the contract and is whisked away into an alternate reality. Now feared by the villagers, Shrek takes the opportunity to cause some lighthearted mischief until he finds that Fiona is a fugitive and his home deserted and desolate. Knocked out and kidnapped by witches, he wakes up in a caged cart driven by Donkey, who has never met him. Donkey tells Shrek he's being taken to Rumpel, now the king of the derelict Far Far Away. Rumpel reveals that he erased the day Shrek was born, meaning Shrek never existed in this alternate timeline. Consequently, Harold and Lillian were forced to sign the kingdom over to Rumpel. When the day ends, Shrek will no longer exist. He escapes Rumpel's castle with Donkey. Initially terrified of Shrek, Donkey decides to trust him after seeing him cry over his erased history. Donkey helps Shrek find a hidden exit clause; the contract can be nullified by """true" love's "kiss""." They soon encounter a still-cursed Fiona leading an army of ogres in a resistance against Rumpel. Shrek discovers a lazy and overweight Puss in Boots being kept as Fiona's pet. Shrek does everything he can to win over Fiona, but she is cynical and disillusioned about the power of true love after nobody rescued her, and she's too busy preparing for an ambush on Rumpel. While sparring with Shrek, Fiona begins to take a liking to him, but they stop short of kissing. Puss encourages Shrek to continue pursuing Fiona. During the ambush, the ogres are captured by the Pied Piper, but Shrek and Fiona escape with the help of Puss and Donkey. Shrek insists that Fiona kiss him, assuring her that it will fix everything; she reluctantly obliges, but nothing happens since she's not in love. When he hears that Rumpel is offering a wish to the one who brings him Shrek, Shrek turns himself in. Rumpel is forced to grant the wish to Shrek, and he uses it to free the other ogres. They storm the castle, battle the witches, and capture Rumpel. As the sun rises, Shrek begins to fade from existence. Having fallen in love with him, Fiona kisses Shrek just before he disappears. Seeing that she's still an ogre in the sunlight, Fiona realizes her curse was broken and that she's assumed """love's" true "form""." The alternate reality disintegrates, and everyone disappears with Rumpel being the last to vanish. Shrek is transported back to the original timeline before he lost his temper at the party. Instead of lashing out, he embraces family and friends with a newfound appreciation. In a mid-credits scene, Rumpel is arrested by the villagers and is put in a cage as punishment.
